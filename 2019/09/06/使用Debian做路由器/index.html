<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
<link rel="stylesheet" href="/css/main.css">

    <title>
    
        ä½¿ç”¨Debianåšè·¯ç”±å™¨ - 
     
    æµ·å¤©å…±ç§‹æ°´ä¸€è‰²
</title>
    <link rel="alternate" href="/rss.xml" type="application/atom+xml">
    <link rel="shortcut icon" href="/favicon.ico">
<meta name="generator" content="Hexo 5.2.0"></head>

<body>
    <div id="root">
        <aside class="aside-wrap" style="background-image: url(https://i.loli.net/2020/12/08/oQ6CXL43HDWpB2I.jpg); width: 300px">
    <img src="https://i.loli.net/2020/12/08/mKOT8BgjFwbof4p.jpg" class="user-avatar" alt="avatar"> 

    <div class="nav-wrap">
        <h1 class="author">vhvy</h1>
        <p class="subtitle">è¿Ÿç‚¹ä¹Ÿå¯ä»¥çš„ã€‚</p>
        <ul class="nav-list">
            
            
            <li class="nav-item">
                <a href="/ ">é¦–é¡µ </a>
            </li>
            
            
            
            <li class="nav-item">
                <a href="/categories ">åˆ†ç±» </a>
            </li>
            
            
            
            <li class="nav-item">
                <a href="/tags ">æ ‡ç­¾ </a>
            </li>
            
            
            
            <li class="nav-item">
                <a href="/chaos ">æ··æ²Œ </a>
            </li>
            
            
            
            <li class="nav-item">
                <a href="/archives ">å½’æ¡£ </a>
            </li>
            
            
            
            <li class="nav-item">
                <a href="/blogroll ">å‹é“¾ </a>
            </li>
            
            
            
            <li class="nav-item">
                <a href="/about ">å…³äº </a>
            </li>
            
            
        </ul>
        <ul class="sub-nav-list">
            
            <li class="sub-nav-item">
                <a target="_blank" rel="noopener" href="https://github.com/vhvy " aria-label="github" title="github" style="background-image: url(https://i.loli.net/2020/11/15/KgnCLhyWJaYpX3U.png);background-color: #fff;background-position: 40%"></a>
            </li>
            
            <li class="sub-nav-item">
                <a href="mailto:vhvy@qq.com " aria-label="email" title="email" style="background-image: url(https://i.loli.net/2020/11/15/ZGnqMQsFutvEcdb.png);background-color: #fff;background-size: 70%"></a>
            </li>
            
            <li class="sub-nav-item">
                <a href="/rss.xml " aria-label="rss" title="rss" style="background-image: url(https://i.loli.net/2020/11/15/mkNMb9soJOVTQWL.png);background-color: #ef7522;background-size: 65%"></a>
            </li>
            
        </ul>
    </div>
</aside>
        <main class="body-box" style="margin-left: 300px;">
            <article class="container">
                
<link rel="stylesheet" href="/css/content.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/prismjs@1.22.0/themes/prism.css">



<div class="content-box">
    <div class="meta">
    <div class="date">
        <time>Sep 06, 2019</time>
    </div>
</div>

    <h1 class="title">ä½¿ç”¨Debianåšè·¯ç”±å™¨</h1>
    <div class="content">
        
        
            
<link rel="stylesheet" href="/css/toc-box.css">

            <div id="toc-wrap">
                <p>
                    <strong>æ–‡ç« ç›®å½•</strong>
                </p>

                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E5%88%92"><span class="toc-text">è®¡åˆ’</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%B7%A5"><span class="toc-text">å¼€å·¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PPPoE"><span class="toc-text">PPPoE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82IPv6%E5%89%8D%E7%BC%80"><span class="toc-text">è¯·æ±‚IPv6å‰ç¼€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dnsmasq"><span class="toc-text">dnsmasq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iptables"><span class="toc-text">iptables</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ipset"><span class="toc-text">ipset</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1"><span class="toc-text">ç­–ç•¥è·¯ç”±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ip6tables"><span class="toc-text">ip6tables</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DDNS"><span class="toc-text">DDNS</span></a></li></ol>
            </div>
        
        
        
        
        <p class="expired-tips">æé†’ï¼šæœ¬æ–‡æœ€åæ›´æ–°äº 474 å¤©å‰ï¼Œæ–‡ä¸­æ‰€æè¿°çš„ä¿¡æ¯å¯èƒ½å·²å‘ç”Ÿæ”¹å˜ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p>
        
        <h2 id="è®¡åˆ’"><a href="#è®¡åˆ’" class="headerlink" title="è®¡åˆ’"></a>è®¡åˆ’</h2><p>ä»¥å‰ä¸€ç›´ä½¿ç”¨RouterOSï¼Œæœ€è¿‘æ›´æ–°ä¹‹åé‡åˆ°äº†ä¸€äº›ä¸¥é‡çš„BUGï¼Œå†³å®šæŠŠå®ƒæ¢æˆLinuxï¼Œå…è´¹å¹¶ä¸”å¯ä»¥é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹Linuxã€‚</p>
<p>Debianä½œä¸ºæœ€æ­£ç»Ÿçš„å‘è¡Œç‰ˆï¼Œæˆ‘å¯¹å®ƒä¸€ç›´å¾ˆæœ‰å¥½æ„Ÿï¼Œå‰å‡ å¤©Debian 10åˆšå¥½ä¹Ÿå‘å¸ƒäº†ï¼Œé‚£ä¹ˆå°±é€‰å®ƒå§ï¼</p>
<p>å¼€å·¥ä¹‹å‰å…ˆè¦æ˜ç¡®ç›®æ ‡ï¼Œä¸ç„¶å°±æ˜¯çå¹²äº†ã€‚</p>
<p>æŸ¥äº†åŠå¤©èµ„æ–™åæ•´ç†å‡ºæ¥ä»¥ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">* Debian è·¯ç”±å™¨æ˜¯æ ¸å¿ƒè·¯ç”±å™¨ï¼Œåªå…³å¿ƒæ•°æ®çš„è½¬å‘ï¼Œä¸åšä»»ä½•å…¶ä»–äº‹æƒ…ã€‚
* &#96;pppoeconf&#96;å®ç°PPPoEæ‹¨å·ä¸Šç½‘ã€‚
* &#96;wide-dhcpv6-client&#96;ä»è¿è¥å•†é‚£é‡Œè·å–IPv6å‰ç¼€ã€‚
* &#96;ipset&#96;å»ºç«‹å›½å†…IPåœ°å€é›†åˆï¼Œä»¥ä¾›iptablesä½¿ç”¨ã€‚
* &#96;iptables&#96;è¿›è¡ŒNATä»¥åŠå¯¹éå›½å†…åœ°å€çš„è¿æ¥è¿›è¡Œæ ‡è®°ï¼Œä¾›&#96;ip rule(ç­–ç•¥è·¯ç”±)&#96;ä½¿ç”¨ã€‚
* &#96;dnsmasq&#96;ä½œä¸ºDNSæœåŠ¡å™¨ä»¥åŠDHCPæœåŠ¡å™¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å¼€å·¥"><a href="#å¼€å·¥" class="headerlink" title="å¼€å·¥"></a>å¼€å·¥</h2><p>æˆ‘æ˜¯åœ¨ESXIä¸­è¿è¡Œè·¯ç”±ç³»ç»Ÿçš„ï¼Œå®‰è£…è¿‡ç¨‹ä¸å†èµ˜è¿°ï¼Œè¿™äº›éƒ½æ˜¯åŸºæœ¬æ“ä½œäº†ã€‚</p>
<p>æˆ‘å…ˆå¤§æ¦‚æè¿°ä¸€ä¸‹æˆ‘çš„ç½‘ç»œç¯å¢ƒï¼Œè¯¸ä½è§‚çœ‹(çœŸçš„æœ‰äººå—?)ç†è§£æ—¶ä¹Ÿä¼šæ›´å®¹æ˜“ã€‚</p>
<p>æš‚æ—¶æ˜¯ç”¨RouterOSä¸Šç½‘çš„ï¼Œç­‰Debian é…ç½®å®Œæˆåå°±ä¼šå…³é—­RouterOSï¼Œä½¿ç”¨Debianä½œä¸ºç½‘å…³è·¯ç”±å™¨ã€‚</p>
<p><img src="/data/images/2019-09-0610.33.28.png" alt="img"></p>
<p>å»ºè®®åˆšè£…å®Œæ—¶å…ˆè¿æ¥ä¸Šåˆ«çš„ç½‘ç»œï¼Œå› ä¸ºéœ€è¦å®‰è£…å„ç§åŒ…ä»¥åŠæ›´æ–°ã€‚ç­‰<code>pppoe</code>è¿æ¥ä¸Šä»¥åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨<code>pppoe</code>ä¸Šç½‘äº†ï¼Œ</p>
<p>å¼€å¯å…å¯†ç™»å½•ï¼Œä¸ç„¶æ¯æ¬¡è¾“å…¥å¯†ç ç™»å½•debianéå¸¸éº»çƒ¦ï¼Œåœ¨è‡ªå·±çš„ç”µè„‘ä¸Šç”Ÿæˆè‡ªå·±çš„keyï¼Œç„¶åcat ~/.ssh/id_rsa.pubï¼Œå¤åˆ¶ä¹‹ååˆ‡æ¢åˆ°Debiançš„ç»ˆç«¯ï¼Œç„¶å</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"ä½ çš„key"</span> <span class="token operator">>></span> ~/.ssh/authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å®‰è£…å®Œæˆåå…ˆæ¢æºï¼Œå»ºè®®ä½¿ç”¨æ¸…åæºï¼Œåˆ‡æ¢åˆ°rootç„¶å<code>apt update &amp;&amp; apt upgrade &amp;&amp; apt install sudo</code>ä¸‰è¿è­¦å‘Šã€‚</p>
<p>ä¸€äº›å¸¸ç”¨å·¥å…·è£…ä¸Šï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">apt install dnsutils wget curl vim<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Debian 10å®‰è£…å®Œæˆåæ™®é€šç”¨æˆ·æ˜¯æ²¡æœ‰sudoæƒé™çš„ï¼Œæˆ‘ä»¬éœ€è¦å»ç»™å®ƒåŠ ä¸Šsudoæƒé™ã€‚è™½ç„¶å¾…ä¼šå®‰è£…è¿‡ç¨‹ä¸­å…¨ç¨‹ä½¿ç”¨rootè´¦æˆ·ï¼Œä½†æ˜¯è¿˜æ˜¯åŠ ä¸Šèˆ’æœä¸€ç‚¹ã€‚</p>
<p>åˆ‡æ¢åˆ°rootè´¦æˆ·ï¼Œç„¶åè¾“å…¥visudoï¼Œæ·»åŠ ä¸€è¡Œä»£ç ï¼Œé¡ºä¾¿æŠŠé»˜è®¤ç¼–è¾‘å™¨æ”¹æˆvimã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">Defaults        editor&#x3D;&#x2F;usr&#x2F;bin&#x2F;vim  # æ”¹æˆè¿™æ ·

...

root    ALL&#x3D;(ALL:ALL) ALL # æ²¡é”™å°±æ˜¯åœ¨è¿™è¡Œä¸‹é¢ğŸ‘‡æ·»åŠ 
user    ALL&#x3D;(ALL:ALL) ALL # useræ›¿æ¢æˆä½ çš„ç”¨æˆ·å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®‰è£…çš„vimé»˜è®¤å¼€å¯äº†å¯è§†åŒ–ï¼Œæƒ³ç”¨é¼ æ ‡å¤åˆ¶ä¸ªä¸œè¥¿å¾ˆå›°éš¾ï¼Œæ‰€ä»¥éœ€è¦å…³é—­vimå¯è§†åŒ–ï¼Œåœ¨<code>/etc/vim/vimrc</code>æœ€åæ·»åŠ ä¸¤è¡Œä»£ç :</p>
<pre class="line-numbers language-none"><code class="language-none">set mouse&#x3D;
set ttymouse&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹æ¥è®¾ç½®ç½‘å¡IPåœ°å€:</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;network&#x2F;interface

auto eth1
iface eth1 inet static
    address 10.1.1.254&#x2F;24
    gateway 10.1.1.233 # è¿™è¡Œåªæ˜¯ä¸ºäº†ä¸´æ—¶ä¸Šç½‘ï¼Œå¾…pppoeè®¾ç½®å®Œæˆä¹‹ååˆ é™¤è¿™è¡Œ

iface eth1 inet6 
    address dd11:1111:1111::1&#x2F;48
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹æ¥éœ€è¦å¼€å¯å†…æ ¸è½¬å‘ï¼Œ<code>vim /etc/sysctl.conf</code></p>
<p>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">net.ipv4.ip_forward&#x3D;1
net.ipv6.conf.all.forwarding&#x3D;1
net.ipv6.conf.ppp0.accept_ra&#x3D;2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åæ‰§è¡Œ<code>sysctl -p /etc/sysctl.conf</code></p>
<h2 id="PPPoE"><a href="#PPPoE" class="headerlink" title="PPPoE"></a>PPPoE</h2><p>é¦–å…ˆéœ€è¦å®‰è£…<code>pppoeconf</code>æ¥è¿›è¡Œpppoeæ‹¨å·ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">apt install pppoeconf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å®‰è£…è¿‡ç¨‹ä¸­ä¼šå‡ºç°è®¾ç½®å‘å¯¼ï¼ŒæŒ‰ç…§æŒ‡å¼•è¾“å…¥è´¦å·å¯†ç å’Œå¯¹åº”çš„ç½‘å¡æ¥å£å°±å¯ä»¥è®¾ç½®å®Œæˆã€‚</p>
<p>è®¾ç½®å®Œæˆåè¾“å…¥<code>ip a</code>å°±å¯ä»¥çœ‹åˆ°<code>pppoe</code>å·²ç»æˆåŠŸæ‹¨å·ã€‚</p>
<p><img src="/data/images/WX20190906-114940@2x.png" alt="img"></p>
<p>æ­¤æ—¶å®ƒä¼šåœ¨<code>/etc/ppp/peers/</code>ä¸‹ç”Ÿæˆä¸€ä¸ª<code>dsl-provider</code>æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†æ‹¨å·ç”¨çš„å„ç§é…ç½®ä¿¡æ¯ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç”¨<code>pon dsl-provider</code>å’Œ<code>poff</code>è¿›è¡Œ<code>pppoe</code>çš„è¿æ¥å’Œæ–­å¼€ï¼Œä½†æ˜¯è¿™ä¹ˆåšä¹Ÿå¤ªä¸ä¼˜é›…äº†ï¼Œè€Œä¸”ä»¥åç®¡ç†èµ·æ¥ä¹Ÿä¸ç”šæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ºå®ƒåˆ¶ä½œä¸€ä¸ª<code>systemd</code>æœåŠ¡ã€‚</p>
<p>é¦–å…ˆåˆ é™¤<code>/etc/network/interface</code>æ–‡ä»¶é‡Œpppoeè‡ªåŠ¨æ·»åŠ çš„é…ç½®ï¼Œç”±äºæˆ‘å·²ç»åˆ æ‰äº†ç›¸å…³ä»£ç ç‰‡æ®µï¼Œæ‰€ä»¥å°±æ— æ³•ä¸Šå›¾äº†ï¼Œè¯¸ä½è‡ªè¡Œåˆ é™¤å°±å¥½ï¼Œä»¥<code>auto ppp0</code>å¼€å¤´çš„å°±æ˜¯ï¼ŒåŒæ—¶æ—è¾¹æœ‰æ³¨é‡Šè¡¨æ˜æ­¤æ®µé…ç½®ä¿¡æ¯ç”±<code>pppoeconf</code>è‡ªåŠ¨ç”Ÿæˆã€‚</p>
<p>åˆ é™¤åæˆ‘ä»¬æ¥åˆ¶ä½œ<code>pppoe.serivce</code>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;pppoe.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">[Unit]
Description&#x3D;PPPoE connection
Before&#x3D;wide-dhcpv6-client.service
[Service]
Type&#x3D;oneshot
RemainAfterExit&#x3D;true
ExecStart&#x3D;&#x2F;usr&#x2F;bin&#x2F;pon dsl-provider
ExecStop&#x3D;&#x2F;usr&#x2F;bin&#x2F;poff -a

[Install]
WantedBy&#x3D;default.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ–‡ä»¶é‡Œ<code>[Unit]</code>å­—æ®µä¸­çš„<code>Before=wide-dhcpv6-client.service</code>æ˜¯ä¸ºäº†è®©<code>pppoe.serive</code>åœ¨è¯·æ±‚ipv6å‰ç¼€æœåŠ¡ä¹‹å‰å¯åŠ¨ï¼Œå¦åˆ™è¯·æ±‚ipv6å‰ç¼€æœåŠ¡ä¼šå¤±è´¥ï¼Œæˆ‘ä»¬ä¸‹é¢ä¼šè¯¦ç»†è®²è§£ã€‚</p>
<p>å†™å…¥ä¹‹åç”¨<code>systemctl daemon-reload </code>å‘½ä»¤é‡æ–°åŠ è½½systemdï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨<code>systemctl start pppoe</code>å’Œ<code>systemctl stop pppoe</code>è¿›è¡Œç®¡ç†äº†ï¼Œå¦å¤–è¿™é‡Œè®°å¾—ä½¿ç”¨<code>systemctl enable pppoe</code>ä½¿å®ƒå¼€æœºè‡ªå¯åŠ¨ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å°†<code>/etc/network/interface</code>ä¸­ç½‘å…³é‚£ä¸€è¡Œåˆ æ‰äº†ï¼Œç°åœ¨æˆ‘ä»¬ä¸éœ€è¦å®ƒå°±å¯ä»¥ä¸Šç½‘äº†ã€‚</p>
<h2 id="è¯·æ±‚IPv6å‰ç¼€"><a href="#è¯·æ±‚IPv6å‰ç¼€" class="headerlink" title="è¯·æ±‚IPv6å‰ç¼€"></a>è¯·æ±‚IPv6å‰ç¼€</h2><p>é¦–å…ˆè¦å®‰è£…ç›¸åº”çš„åŒ…ï¼š<code>apt install wide-dhcpv6-client</code>ï¼Œç„¶åä¸ºä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;wide-dhcpv6&#x2F;dhcp6c.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">interface ppp0 &#123;
    send ia-pd 0;
&#125;;

id-assoc pd 0 &#123;
    prefix-interface eth0 &#123;
        sla-id 1;
        sla-len 0;
    &#125;;
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­<code>eth0</code> æ˜¯æˆ‘ç”¨æ¥æ‹¨å·çš„ç‰©ç†æ¥å£ï¼Œ<code>sla-len</code>è§†å‰ç¼€æƒ…å†µè€Œå®šï¼Œæ€»ä¹‹è¿™ä¸ªæ•°å­—å’Œä½ çš„å‰ç¼€ç›¸åŠ è¦ç­‰äº64ï¼Œç”µä¿¡ç»™æˆ‘çš„å‰ç¼€æ˜¯<code>::/64</code>ï¼Œæˆ‘è¿™é‡Œå°±å¡«0ï¼›å¦‚æœä½ çš„æ˜¯<code>::/56</code>ï¼Œé‚£ä¹ˆä½ è¿™é‡Œå°±å¡«8;</p>
<p>æ¥ä¸‹æ¥ä½¿ç”¨<code>systemctl start wide-dhcpv6-client</code>è¿›è¡Œè·å–å‰ç¼€ï¼Œå¾…å‘½ä»¤æ‰§è¡Œç»“æŸä½¿ç”¨<code>ip a</code>å‘½ä»¤å°±å¯ä»¥çœ‹åˆ°ipv6åœ°å€å·²ç»ä¸‹å‘æˆåŠŸã€‚</p>
<p>ä½¿ç”¨<code>systemctl enable wide-dhcpv6-client</code>å®ç°å¼€æœºè‡ªå¯åŠ¨ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œæœ‰ç‚¹å‘ï¼Œé‡å¯åå‘ç°è¿™ä¸ªæœåŠ¡ä¼šå¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹å¤±è´¥åŸå› æ˜¯å› ä¸º<code>ppp0</code>æ¥å£ä¸å­˜åœ¨?!</p>
<p>å¯æ˜¯æˆ‘æ˜æ˜å†™äº†<code>Before</code>è®©è¿™ä¸ªæœåŠ¡åœ¨<code>pppoe</code>æœåŠ¡ä¹‹åå¯åŠ¨ï¼Œç”¨äº†ä¸€äº›å…¶ä»–æŠ€å·§ä¹Ÿç€å®è¯æ˜äº†å¯åŠ¨é¡ºåºæ²¡é”™ï¼Œç™¾æ€ä¸å¾—å…¶è§£ä¹‹åæˆ‘ç”¨äº†æœ€ç®€å•ç²—æš´çš„æ–¹æ³•-<code>å»¶æ—¶å¯åŠ¨</code>ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;init.d&#x2F;wide-dhcpv6-client<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>åœ¨å¯åŠ¨è„šæœ¬ä¹‹å‰è®©å®ƒç¡ä¸Š8ç§’:</p>
<pre class="line-numbers language-none"><code class="language-none">STOP_RETRY_SCHEDULE&#x3D;&#39;TERM&#x2F;20&#x2F;forever&#x2F;KILL&#x2F;1&#39;

. &#x2F;lib&#x2F;lsb&#x2F;init-functions

test -x $DHCP6CBIN || exit 0

sleep 8  # æ²¡é”™ï¼Œå°±æ˜¯åœ¨è¿™é‡Œå¿µå’’è¯­è®©å®ƒç¡8ç§’ã€‚

if [ ! -f &#x2F;etc&#x2F;default&#x2F;wide-dhcpv6-client ]; then
    exit 0
else
    . &#x2F;etc&#x2F;default&#x2F;wide-dhcpv6-client
fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œå¼€æœºä¹‹åå¯ä»¥æ­£å¸¸è¯·æ±‚åˆ°IPv6å‰ç¼€äº†ã€‚</p>
<p>ç”µä¿¡å¾ˆå¤šåœ°æ–¹æ¯éš”48æˆ–è€…72å°æ—¶ä¼šå¼ºè¡Œæ‰çº¿ä¸€æ¬¡ï¼Œä¹‹åæˆ‘ä»¬åˆéœ€è¦æ‰‹åŠ¨é‡å¯<code>wide-dhcpv6-client</code>æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬æä¸ªè„šæœ¬è®©å®ƒå‡Œæ™¨2ç‚¹è‡ªåŠ¨é‡æ–°æ‹¨å·å¹¶è·å–IPv6å‰ç¼€ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">
vim &#x2F;root&#x2F;tools&#x2F;autoConnect.sh


#!&#x2F;bin&#x2F;bash
systemctl restart pppoe
systemctl restart wide-dhcpv6-client<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åä½¿ç”¨<code>crontab -e</code>æ·»åŠ è„šæœ¬:</p>
<pre class="line-numbers language-none"><code class="language-none">0 2 * * * &#x2F;bin&#x2F;bash &#x2F;root&#x2F;tools&#x2F;autoConnect.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="dnsmasq"><a href="#dnsmasq" class="headerlink" title="dnsmasq"></a>dnsmasq</h2><p>é¦–å…ˆå®‰è£…<code>dnsmasq</code>ï¼š </p>
<pre class="line-numbers language-none"><code class="language-none">apt install dnsmasq<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>dnsmasq</code>çš„é…ç½®æ–‡ä»¶æ”¾åœ¨<code>/etc/dnsmasq.d</code>ä¸‹é¢ï¼Œä»¥<code>.conf</code>ç»“å°¾çš„é…ç½®æ–‡ä»¶ä¼šè¢«<code>dnsmasq</code>è§£æï¼Œè€Œ<code>dnsmasq</code>çš„é…ç½®æ¨¡ç‰ˆæ–‡ä»¶åœ¨<code>/etc/dnsmasq.conf</code>ï¼Œå…³äºé…ç½®æ–‡ä»¶æˆ‘å°±ä¸å†èµ˜è¿°ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šè¯¦è§£ï¼Œæˆ‘è¿™é‡Œå±•ç¤ºä¸€ä¸‹æˆ‘çš„é…ç½®æ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">cat &#x2F;etc&#x2F;dnsmasq.d&#x2F;custom.dnsmasq.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">interface&#x3D;eth1
bind-interfaces
dhcp-range&#x3D;eth1,10.1.1.100,10.1.1.140,255.255.255.0,12h
dhcp-range&#x3D;eth1,::1,constructor:eth1,ra-names,12h
listen-address&#x3D;127.0.0.1,10.1.1.254,dd78:1111:1111::1,::1
port&#x3D;53
server&#x3D;1.2.4.8
server&#x3D;114.114.114.114
enable-ra

# Option
dhcp-option&#x3D;option:netmask,255.255.255.0
dhcp-option&#x3D;option:router,10.1.1.254
dhcp-option&#x3D;option:dns-server,10.1.1.254,1.2.4.8,114.114.114.114
dhcp-option&#x3D;option6:dns-server,[dd78:1111:1111::1]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†RouterOSå…³é—­äº†ï¼Œdebianå·²åŸºæœ¬é…ç½®å®Œæˆï¼Œæˆ‘ä»¬è®¾ç½®NATä¹‹åå°±å¯ä»¥ä¸Šç½‘äº†ã€‚</p>
<p>ä½¿ç”¨<code>systemctl restart dnsmasq</code>é‡æ–°å¯åŠ¨dnsmasqï¼Œå¼€æœºå¯åŠ¨æœåŠ¡çš„æŒ‡ä»¤ç›¸æ¯”æˆ‘ä¹Ÿä¸ç”¨åœ¨é‡å¤äº†ã€‚</p>
<h2 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h2><p>ç”µè„‘ç°åœ¨è¿˜ä¸èƒ½ä¸Šç½‘ï¼Œå…ˆé…ç½®ä¸¤æ¡è§„åˆ™ï¼Œè®©ç”µè„‘å¯ä»¥ä¸Šç½‘ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">iptables -t nat -A POSTROUTING -s 10.1.1.0&#x2F;24 -o ppp0 -j MASQUERADE
ip6tables -t nat -A POSTROUTING -s dd78:1111:1111::&#x2F;48 -j MASQUERADE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>iptablesè§„åˆ™ç”Ÿæˆä¹‹åæ˜¯åœ¨å†…å­˜é‡Œçš„ï¼Œé‡å¯ä¹‹åä¼šå¤±æ•ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®ˆæŠ¤ç¨‹åºæ¥ä¿å­˜iptablesè§„åˆ™ï¼Œå¹¶ä¸”åœ¨å¼€æœºæ—¶æ¢å¤è§„åˆ™ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">apt install iptables-persistent<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>ç„¶åæˆ‘ä»¬å°†è§„åˆ™ä¿å­˜åœ¨è¿™é‡Œï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">iptables-save &gt; &#x2F;etc&#x2F;iptables&#x2F;rules.v4
ip6tables-save &gt; &#x2F;etc&#x2F;iptables&#x2F;rules.v6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å°†æ­¤æœåŠ¡è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨åï¼Œå®ƒä¼šè‡ªåŠ¨ä»è¿™ä¸¤ä¸ªæ–‡ä»¶è¯»å–é…ç½®ä¿¡æ¯ã€‚</p>
<p>å¦å¤–<code>iptables-persistent</code>å®‰è£…åç”¨systemctlç®¡ç†æ—¶ï¼Œåç§°ä¸º<code>netfilter-persistent</code>ï¼Œæˆ‘åˆšå¼€å§‹è®¾ç½®å¼€æœºå¯åŠ¨æ—¶æç¤ºæ²¡æœ‰è¿™ä¸ªæœåŠ¡ä¹Ÿæ˜¯æ‘¸ä¸ç€å¤´è„‘ï¼ŒæŸ¥äº†åŠå¤©æ‰çŸ¥é“å®‰è£…ä¹‹åæ˜¯å«è¿™ä¸ªåå­—ã€‚</p>
<h2 id="ipset"><a href="#ipset" class="headerlink" title="ipset"></a>ipset</h2><p>ç°åœ¨åŸºæœ¬é…ç½®å®Œæˆï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦åˆ†æµå›½å†…å¤–æµé‡ï¼Œå°†å›½å¤–IPæµé‡å®šå‘è‡³å¦ä¸€æ¡çº¿è·¯è¿›è¡ŒåŠ é€Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ipsetç»´æŠ¤ä¸€ä¸ªå›½å†…IPåˆ—è¡¨ã€‚</p>
<p>é¦–å…ˆå®‰è£…ipset:</p>
<pre class="line-numbers language-none"><code class="language-none">apt install ipset<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªéå…¬ç½‘åœ°å€çš„åˆ—è¡¨ï¼Œåé¢æœ‰ç”¨å¾—åˆ°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ipset create localIPv4 hash:net
ipset add localIPv4 10.0.0.0&#x2F;8
ipset add localIPv4 172.16.0.0&#x2F;12
ipset add localIPv4 192.168.0.0&#x2F;16
ipset add localIPv4 100.64.0.0&#x2F;10

ipset save &gt; &#x2F;etc&#x2F;ipset&#x2F;ipset.conf  # ä¿å­˜åˆ°æ–‡ä»¶é‡Œ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ipsetåˆ—è¡¨ä¿å­˜ä¹‹åä¿å­˜åœ¨å†…å­˜é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœåŠ¡æ¥è®©å®ƒå¼€æœºè¯»å–æ–‡ä»¶æ¢å¤åˆ—è¡¨ã€‚</p>
<p>ä»£ç å¦‚ä¸‹:</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;ipset.service


[Unit]
Description&#x3D;ipset persistent rule service
Before&#x3D;iptables.service netfilter-persistent.service
[Service]
Type&#x3D;oneshot
RemainAfterExit&#x3D;yes
ExecStart&#x3D;&#x2F;usr&#x2F;sbin&#x2F;ipset restore -f &#x2F;etc&#x2F;ipset&#x2F;ipset.conf
ExecStop&#x3D;&#x2F;usr&#x2F;sbin&#x2F;ipset save &gt; &#x2F;etc&#x2F;ipset&#x2F;ipset.conf
[Install]
WantedBy&#x3D;multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åsystemctlä¸‰è¿:</p>
<pre class="line-numbers language-none"><code class="language-none">systemctl daemon-reload
systemctl enable ipset
systemctl start ipset<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿˜éœ€è¦å°†ä¸­å›½å¤§é™†çš„IPæ®µå†™å…¥ipsetï¼Œè¿™é‡Œæˆ‘æäº†ä¸ªè„šæœ¬ï¼Œå¯ä»¥ç›´æ¥æ‹¿å»ä½¿ç”¨ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">#!&#x2F;bin&#x2F;bash

curl &#39;http:&#x2F;&#x2F;ftp.apnic.net&#x2F;apnic&#x2F;stats&#x2F;apnic&#x2F;delegated-apnic-latest&#39; | grep CN &gt; &#x2F;tmp&#x2F;cnIP.txt

# Test IPv4 list

ipError&#x3D;&quot;NOT&quot;
listError&#x3D;&quot;not exist&quot;
result&#x3D;$(ipset list cnIPv4 2&gt;&amp;1)

if [[ $result &#x3D;~ $listError ]]
then
    ipset create cnIPv4 hash:net
    echo &quot;cnIPv4é›†åˆä¸å­˜åœ¨,å·²åˆ›å»º!&quot;
else
    ipset flush cnIPv4
    echo &quot;cnIPv4é›†åˆå­˜åœ¨,å·²æ¸…ç©º!&quot;
fi

# Update IPv4 List
cat &#x2F;tmp&#x2F;cnIP.txt | grep ipv4 | awk -F\| &#39;&#123; printf(&quot;%s&#x2F;%d\n&quot;, $4, 32-log($5)&#x2F;log(2)) &#125;&#39; &gt; &#x2F;tmp&#x2F;cnIPv4.txt
cat &#x2F;tmp&#x2F;cnIPv4.txt | while read line
do
    result&#x3D;$(ipset test cnIPv4 $line 2&gt;&amp;1)
    if [[ $result &#x3D;~ $ipError ]]
    then
	    ipset add cnIPv4 $line
    fi
done
echo &quot;cnIPv4æ›´æ–°å®Œæ¯•!!&quot;
rm &#x2F;tmp&#x2F;cnIPv4.txt

# Test IPv6 List

result&#x3D;$(ipset list cnIPv6 2&gt;&amp;1)

if [[ $result &#x3D;~ $listError ]]
then
    ipset create cnIPv6 hash:net family inet6
    echo &quot;cnIPv6é›†åˆä¸å­˜åœ¨,å·²åˆ›å»º!&quot;
else
    ipset flush cnIPv6
    echo &quot;cnIPv6é›†åˆå­˜åœ¨,å·²æ¸…ç©º!&quot;
fi

# Update IPv6 List
cat &#x2F;tmp&#x2F;cnIP.txt | grep ipv6 | awk -F\| &#39;&#123; printf(&quot;%s&#x2F;%d\n&quot;, $4, 32-log($5)&#x2F;log(2)) &#125;&#39; &gt; &#x2F;tmp&#x2F;cnIPv6.txt
cat &#x2F;tmp&#x2F;cnIPv6.txt | while read line
do
    result&#x3D;$(ipset test cnIPv6 $line 2&gt;&amp;1)
    if [[ $result &#x3D;~ $ipError ]]
    then
        ipset add cnIPv6 $line
    fi
done
echo &quot;cnIPv6æ›´æ–°å®Œæ¯•!!&quot;
rm &#x2F;tmp&#x2F;cnIPv6.txt
rm &#x2F;tmp&#x2F;cnIP.txt

# Save to files
ipset save &gt; &#x2F;etc&#x2F;ipset&#x2F;ipset.conf
echo &quot;ipsetå·²å†™å…¥æ–‡ä»¶!!!&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="ç­–ç•¥è·¯ç”±"><a href="#ç­–ç•¥è·¯ç”±" class="headerlink" title="ç­–ç•¥è·¯ç”±"></a>ç­–ç•¥è·¯ç”±</h2><p>å†…ç½‘æœ‰ä¸€å°ä»£ç†æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å»å¾€å›½å†…çš„æµé‡å…¨éƒ¨äº¤ç»™è¿™å°ä»£ç†æœåŠ¡å™¨ï¼Œè¿™é‡Œå°±éœ€è¦åšç­–ç•¥è·¯ç”±ã€‚</p>
<p>åŒæ—¶å› ä¸ºä¸ºäº†é˜²æ­¢æµªè´¹æµé‡ï¼Œåªå°†éœ€è¦åŠ é€Ÿçš„è®¾å¤‡æµé‡è½¬å‘ç»™ä»£ç†æœåŠ¡å™¨ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»´æŠ¤ä¸€ä¸ªipsetåˆ—è¡¨ï¼Œå°†è¿™äº›è®¾å¤‡IPåœ°å€æ”¾è¿›å»ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ipset create goWorld hash:net
ipset add goWorld 10.1.1.22  ##è‡ªè¡Œè¾“å…¥ä½ çš„è®¾å¤‡ipåœ°å€<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ç„¶åæ·»åŠ ä¸€ä¸ªè·¯ç”±è¡¨ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;iproute2&#x2F;rt_tables


252 goProxy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å±€åŸŸç½‘ä»£ç†æœåŠ¡å™¨åœ°å€ä¸º10.1.1.88ã€‚</p>
<p>ç„¶åæ·»åŠ ä¸€æ¡è·¯ç”±ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ip route add default via 10.1.1.88 table goProxy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶ååœ¨iptablesé˜²ç«å¢™é‡Œå¯¹è¿™äº›è®¾å¤‡æµé‡è¿›è¡Œæ ‡è®°ï¼Œå¹¶å°†è¿™äº›è®¾å¤‡çš„dnsè¯·æ±‚è½¬å‘ç»™ä»£ç†æœåŠ¡å™¨ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">iptables -t mangle -A PREROUTING -m set --match-set goWorld src -m set ! --match-set localIPv4 dst -m set ! --match-set cnIPv4 dst -j MARK --set-mark 20

iptables -t nat -A PREROUTING -p udp --dport 53 -m set --match-set goWorld src -j DNAT  --to-destination 10.1.1.88:53
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>è®°å¾—ç”¨<code>iptables-save &gt; /etc/iptables/rules.v4</code>è¿›è¡Œä¿å­˜ï¼</p>
<p>ç„¶åæ·»åŠ ç­–ç•¥è·¯ç”±:</p>
<pre class="line-numbers language-none"><code class="language-none">ip rule add fwmark 20 table goProxy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>éœ€è¦æ³¨æ„è¿™äº›è·¯ç”±ä¹Ÿæ˜¯ä¿å­˜åœ¨å†…å­˜çš„ï¼Œä¸ºäº†è®©å®ƒæ°¸ä¹…ç”Ÿæ•ˆï¼Œéœ€è¦å°†å®ƒå†™è¿›ç½‘å¡é…ç½®æ–‡ä»¶é‡Œï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;network&#x2F;interface

...

auto eth1
iface eth1 inet static
    address 10.1.1.254&#x2F;24
    up ip route add default via 10.1.1.88 table goProxy
    down ip route del default via 10.1.1.88 table goProxy
    up ip rule add fwmark 20 table goProxy
    down ip rule del fwmark 20 table goProxy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œå»å¾€å›½å¤–çš„æµé‡å°±å…¨éƒ¨èµ°äº†ä»£ç†æœåŠ¡å™¨ï¼Œå®‰è£…npmåŒ…çš„æ—¶å€™å†ä¹Ÿä¸ç”¨ç­‰ä¸ªååˆ†é’Ÿå•¦ï¼ä¸‡å²ï¼</p>
<h2 id="ip6tables"><a href="#ip6tables" class="headerlink" title="ip6tables"></a>ip6tables</h2><p>ipv6ä»£ç†å’Œipv4æ˜¯ä¸€ä¸ªå¥—è·¯ï¼Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚</p>
<p>å¦å¤–æˆ‘IPv6çš„ä»£ç†æ­å»ºå®Œæ¯•åï¼Œå‘ç°é€Ÿåº¦è¿˜æ˜¯éå¸¸å·®åŠ²ï¼Œä¸å¦‚IPv4ï¼Œæˆ‘å°±ç›´æ¥ä¸ç”¨IPv6äº†ã€‚</p>
<p>æ³¨æ„è¿™é‡Œçš„IPv6ä¸æ˜¯è¯´å®Œå…¨ä¸ç”¨ï¼Œåªæ˜¯åœ¨é˜²ç«å¢™ä¸Šå°†å»å¾€å›½å¤–çš„IPv6æµé‡å…¨éƒ¨rejectæ‰ï¼Œè¿™æ ·ç¨‹åºå°±ä¼šä¹–ä¹–çš„ä½¿ç”¨IPv4ï¼Œè€Œå›½å†…IPv6é€Ÿåº¦å°šå¯ï¼Œå®Œå…¨ä¸ç”¨å…³é—­å®ƒã€‚</p>
<p>returnè¿™é‡Œæˆ‘å®éªŒäº†å¾ˆå¤šæ¬¡æ‰è°ƒè¯•å¥½ï¼Œå¾ˆå¤šç¨‹åºåœ¨ä½¿ç”¨é˜²ç«å¢™dropæ—¶ä¼šç«‹åˆ»å›è½åˆ°IPv4ï¼Œæœ‰äº›ç¨‹åºåœ¨rejectæ—¶æ‰ä¼šç«‹åˆ»å›è½åˆ°IPv4ï¼Œæå¾—äººå¾ˆæ˜¯å¤´å¤§ï¼Œæœ€åçš„è¯•éªŒå‡ºçš„å…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ip6tables -A FORWARD -m set ! --match-set cnIPv6 dst ! -d dd78:1111:1111::&#x2F;48 -j REJECT --reject-with icmp6-adm-prohibited<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="DDNS"><a href="#DDNS" class="headerlink" title="DDNS"></a>DDNS</h2><p>è¿™é‡Œæˆ‘ä¹Ÿå†™äº†ä¸€ä¸ªç°æˆçš„shellè„šæœ¬ï¼Œæˆ‘æ”¾åœ¨äº†<a target="_blank" rel="noopener" href="https://github.com/vhvy/namesilo-ddns">github</a>ä¸Šï¼Œæœ‰éœ€è¦è¯·è‡ªå–ã€‚</p>

    </div>
</div>

<div class="pagination">
    
    
    <a href="/2019/08/08/åšå®¢ç°å·²ç”¨Reacté‡å†™/" class="link next">åšå®¢ç°å·²ç”¨Reacté‡å†™</a>
    
</div>
            </article>
            <footer class="footer">
    <p class="copyright">Â©ï¸ 2018 - 2020 æµ·å¤©å…±ç§‹æ°´ä¸€è‰²</p>
    <p class="powered">Powered By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/vhvy/hexo-theme-veni">Veni</a></p>
</footer>
        </main>
    </div>
</body>

</html>